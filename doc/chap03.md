3장 64비트 프로세서의 이모저모
==========================
# 3.1 운영모드
리얼모드
- 프로세서가 어떤 상태나 모드에 있든 전원이 켜지거나 리셋되면 리얼모드로 진입

보호모드
- OS 보안, 멀티티태스킹, 세그먼테이션, 페이징 등의 기능을 하드웨어 적으로 지원

IA-32e 모드
- 보호모드와 비슷
- 32비트 호환모드가 존재

```
BIOS는 디스크 읽기 및 쓰기 기능부터 그래픽 모드로 전환하는 기능 등 여러 가지 기능을 제공, 별도의 디바이스 드라이버를 제작하지 않고도 원하는 작업을 수행할 수 있음
```

# 3.2 운영모드와 레지스터
```
레지스터는 프로세서 내부에 있는 작은 메모리,
```

범용 레지스터
- 계산, 메모리 어드레스 지정, 임시 저장 공간 등의 목적으로 사용
- 용도가 고정된 것이 아니며, 다양한 목적으로 사용될 수 있다.
- IA-32e 모드에서 오퍼랜드 접두사가 붙지 않으면 32비트 크기만 사용가능하다. REX 접두사를 붙여 사용하면 64비트 크기를 사용할 수 있다.

세그먼트 레지스터
- 16비트 레지스터로 메모리 영역을 다양한 크기로 구분하는 역할을 한다.
- CS는 코드 영역, DS는 데이터 영역, SS는 스택 영역을 가르킬때 암시적으로 사용 등이 있다.

컨트롤 레지스터
- CPU의 운영 모드를 변경하고, 현재 운영 중인 모드의 특정 기능을 제어하는 레지스터
- 레지스터의 각 비트는 CPU의 특정 기능 활성/비활성을 의미한다.
- 

# 3.3 운영모드와 메모리 관리 기법
세그먼테이션
- 메모리를 원하는 크기로 잘라먹을 수 있는 케이크로 비유할 수 있다.
- 세그먼트 레지스터에 세그먼트의 시작 주소 혹은 디스크립터라고 불리는 자료구조의 위치를 설정해야한다.

페이징
- 메모리를 식빵처럼 잘라놓은 부분을 모아 사용하는 기법이다.
- CR3 레지스터에 페이지 디렉터라고 불리는 자료구조의 물리 주소를 설정해야 사용할 수 있다.

## 리얼모드 메모리 관리 방식
- 세그먼테이션만 지원
- 세그먼트 크기는 64K로 고정이고, 세그먼트의 시작 주소는 세그먼트 레지스터에 직접 설정
- 암시적으로 세그먼트 레지스터 * 16을 하여 16비트 레지스터로 1MB 메모리에 접근할 수 있다.

## 보호모드 메모리 관리 방식
- 보호모드에서는 세그먼트 레지스터의 값으로 직접 메모리에 접근하지 않고, 암시적으로 메모리에 있는 세그먼트 디스크립터의 자료구조를 참조하여 메모리에 접근한다.
- 보호모드에서는 리얼 모드와 달리 세그먼트의 크기를 지정할 수 있으므로, 세그먼트의 크기가 64KB로 고정되지 않는다.
- 할당된 세그먼트 크기를 넘어 메모리에 접근하면 프로세서는 예외를 발생시킨다.

## IA-32e 모드 메모리 관리 방식
- 64비트 모드에서 세그먼트 디스크립터에 설정된 기준 주소와 크기를 무시하고 모든 세그먼트가 기준 주소는 0, 크기는 64비트 전체로 설정된다.
